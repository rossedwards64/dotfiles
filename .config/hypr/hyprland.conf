$MOD=SUPER
$HOME=/home/ross

# script paths
$LOCKSCRIPT="$HOME/.local/bin/lock"
$SCREENSHOT="$HOME/.config/rofi/scripts/screenshot"
$WOBSCRIPT="$HOME/.local/bin/wob"
$MENU="$HOME/.config/rofi/scripts/launcher"
$POWERMENU="$HOME/.config/rofi/scripts/powermenu"
$CLIPBOARD="$HOME/.config/rofi/scripts/clipboard.sh"

# enviroment
$SESSION_VARS=DISPLAY WAYLAND_DISPLAY XDG_CURRENT_DESKTOP XDG_SESSION_TYPE XDG_SESSION_DESKTOP

# hyprctl stuff
$SLEEP='hyprctl dispatch dpms off' resume 'hyprctl dispatch dpms on'

# sockets
$WOBSOCK="$XDG_RUNTIME_DIR/wob.sock"

# regexps
$STEAM_GAME=^(steam_app_[0-9]*)$
$ANY=^(.*)$

# window decoration variables
$ACTIVE_COL=rgb(64727d)
$INACTIVE_COL=rgb(212b30)
$ACTIVE_GROUP=rgb(1794d2)
$INACTIVE_GROUP=$INACTIVE_COL

env=XCURSOR_SIZE,24
env=XDG_CURRENT_DESKTOP,Hyprland
env=XDG_SESSION_TYPE,wayland
env=XDG_SESSION_DESKTOP,Hyprland

# monitor setup
$MONITOR=LVDS-1
monitor=$MONITOR,1366x768@60,0x0,1

# background programs
exec-once=hyprpaper
exec-once=$HOME/.config/hypr/scripts/start_xdph.sh
exec-once=dbus-update-activation-environment --systemd $SESSION_VARS
exec-once=systemctl --user import-environment $SESSION_VARS
exec-once=swayidle -w timeout 600 $LOCKSCRIPT timeout 900 $SLEEP before-sleep $LOCKSCRIPT
exec-once=wl-paste --type text --watch cliphist store
exec-once=wl-paste --type image --watch cliphist store
exec-once=udiskie -ant &

# normal programs
exec-once=waybar
exec-once=emacsclient -c -a=""
exec-once=alacritty
exec-once=firefox
exec-once=flatpak run com.discordapp.Discord
exec-once=spot
exec-once=env PROTON_USE_WINED3D=1 steam
exec-once=lutris
#exec-once=intellij-idea-ultimate-edition

# programs to restart on hyprland reload
exec=rm -f $WOBSOCK && mkfifo $WOBSOCK && tail -f $WOBSOCK | wob
exec=pkill waybar && waybar &

general {
    gaps_in=5
    gaps_out=5
    border_size=2
    col.active_border=$ACTIVE_COL
    col.inactive_border=$INACTIVE_COL
    apply_sens_to_raw=no
    layout="master"
}

input {
    kb_file=
    kb_layout=gb
    kb_variant=
    kb_model=
    kb_options=ctrl:nocaps
    kb_rules=
    follow_mouse=yes
    sensitivity=0 # -1.0 - 1.0, 0 means no modification.

    touchpad {
        natural_scroll=no
        scroll_factor=1.0
        tap-to-click=yes
        tap-and-drag=no
    }
}

gestures {
    workspace_swipe=yes
    workspace_swipe_fingers=3
    workspace_swipe_distance=150
}

plugin {
    hyprbars {
        bar_height=24
        bar_text_font=Iosevka Nerd Font
        bar_text_size=13
    }
}

decoration {
    blur {
        enabled=yes
        size=3 # minimum 1
        passes=6 # minimum 1
        new_optimizations=yes
        xray=yes
        ignore_opacity=no
    }

    rounding=14
    multisample_edges=yes
    active_opacity=0.9
    inactive_opacity=0.8
    fullscreen_opacity=1.0
    shadow_range=10
    shadow_render_power=3
    col.shadow=0x990f0f0f
}

binds {
    workspace_back_and_forth=yes
    allow_workspace_cycles=yes
    focus_preferred_method=1
}

dwindle {
    pseudotile=yes
    preserve_split=yes
    force_split=yes
    use_active_for_splits=yes
}

master {
    new_is_master=no
    new_on_top=yes
    no_gaps_when_only=yes
    orientation=left
    inherit_fullscreen=yes
    always_center_master=no
}

misc {
    vfr=yes
    vrr=2
    enable_swallow=yes
    focus_on_activate=yes
    mouse_move_enables_dpms=yes
    key_press_enables_dpms=yes
    animate_mouse_windowdragging=yes
    animate_manual_resizes=yes
}

animations {
    enabled=true
    bezier=overshot,0.05,0.9,0.1,1.05
    bezier=smoothOut,0.36,0,0.66,-0.56
    bezier=smoothIn,0.25,1,0.5,1

    animation=windows,1,5,overshot,slide
    animation=windowsOut,1,4,smoothOut,slide
    animation=windowsMove,1,4,default
    animation=border,1,10,default
    animation=fade,1,10,smoothIn
    animation=fadeDim,1,10,smoothIn
    animation=workspaces,1,6,default,slide
}

# window rules
windowrule=float,Rofi
windowrule=pin,Rofi
windowrule=center,Rofi

windowrule=noblur,firefox
windowrule=opaque,firefox
windowrule=noblur,mpv
windowrule=opaque,mpv
windowrule=noblur,vlc
windowrule=opaque,vlc

windowrulev2=float,class:xdm-app

windowrulev2=noblur,class:$STEAM_GAME
windowrulev2=opaque,class:$STEAM_GAME
windowrulev2=center,class:$STEAM_GAME
windowrulev2=fullscreen,class:$STEAM_GAME

windowrulev2=workspace 1 silent,class:emacs
windowrulev2=workspace 2 silent,class:Alacritty
windowrulev2=workspace 3 silent,class:firefox
windowrulev2=workspace 4 silent,class:discord
windowrulev2=workspace 5 silent,class:^(.*Spot)$
windowrulev2=workspace 6 silent,class:^(steam)$
windowrulev2=workspace 6 silent,class:lutris
windowrulev2=workspace 7 silent,class:$STEAM_GAME
windowrulev2=workspace 7 silent,class:^(gamescope)$
windowrulev2=workspace 9 silent,class:jetbrains-idea

# some nice mouse binds
bindm=$MOD,mouse:272,movewindow
bindm=$MOD,mouse:273,resizewindow

# keybinds
bindr=$MOD,d,exec,pkill rofi || $MENU
bindr=$MOD,ESCAPE,exec,pkill rofi || $POWERMENU

bind=$MOD,RETURN,exec,alacritty
bind=$MODSHIFT,e,exec,emacsclient -c -a=""
bind=$MODSHIFT,c,exec,hyprctl reload && notify-send "Reloaded Hyprland"
bind=$MOD,f,fullscreen
bind=$MODSHIFT,q,killactive,
bind=$MODSHIFT,m,exit,
bind=$MOD,y,togglefloating,
bind=$MOD,p,pseudo,
bind=$MOD,v,exec,$CLIPBOARD
bind=$MODSHIFT,b,pin

bind=,Print,exec,$SCREENSHOT
bind=SHIFT,Print,exec,$SCREENSHOT "$HOME/Pictures/screenshots"

#bindel=,XF86MonBrightnessUp,exec,brightnessctl set 5%+
#bindel=,XF86MonBrightnessDown,exec,brightnessctl set 5%-
#bindel=,XF86MonBrightnessUp,exec,$WOBSCRIPT "-b" "-i5"
#bindel=,XF86MonBrightnessDown,exec,$WOBSCRIPT "-b" "-d5"
bindel=,XF86AudioRaiseVolume,exec,$WOBSCRIPT "-v" "-i5"
bindel=,XF86AudioLowerVolume,exec,$WOBSCRIPT "-v" "-d5"
bindl=,XF86AudioMute,exec,wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle && "$HOME/.local/bin/check-mute" "getspeaker"
bindl=,XF86AudioMicMute,exec,wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle && "$HOME/.local/bin/check-mute" "getmic"
bindel=,XF86AudioNext,exec,playerctl next
bindel=,XF86AudioPrev,exec,playerctl previous
bindel=,XF86AudioPlay,exec,playerctl play-pause
bindel=,XF86AudioStop,exec,playerctl stop

binde=$MOD,left,movefocus,l
binde=$MOD,h,movefocus,l
binde=$MOD,right,movefocus,r
binde=$MOD,l,movefocus,r
binde=$MOD,up,movefocus,u
binde=$MOD,k,movefocus,u
binde=$MOD,down,movefocus,d
binde=$MOD,j,movefocus,d
binde=$MODSHIFT,h,movewindow,l
binde=$MODSHIFT,left,movewindow,l
binde=$MODSHIFT,l,movewindow,r
binde=$MODSHIFT,right,movewindow,r
binde=$MODSHIFT,k,movewindow,u
binde=$MODSHIFT,up,movewindow,u
binde=$MODSHIFT,j,movewindow,d
binde=$MODSHIFT,down,movewindow,d

binde=$MODCTRL,h,resizeactive,-25 0
binde=$MODCTRL,l,resizeactive,25 0
binde=$MODCTRL,k,resizeactive,0 -25
binde=$MODCTRL,j,resizeactive,0 25

bind=$MOD,1,workspace,1
bind=$MOD,2,workspace,2
bind=$MOD,3,workspace,3
bind=$MOD,4,workspace,4
bind=$MOD,5,workspace,5
bind=$MOD,6,workspace,6
bind=$MOD,7,workspace,7
bind=$MOD,8,workspace,8
bind=$MOD,9,workspace,9
bind=$MOD,0,workspace,10

bind=$MODSHIFT,1,movetoworkspace,1
bind=$MODSHIFT,2,movetoworkspace,2
bind=$MODSHIFT,3,movetoworkspace,3
bind=$MODSHIFT,4,movetoworkspace,4
bind=$MODSHIFT,5,movetoworkspace,5
bind=$MODSHIFT,6,movetoworkspace,6
bind=$MODSHIFT,7,movetoworkspace,7
bind=$MODSHIFT,8,movetoworkspace,8
bind=$MODSHIFT,9,movetoworkspace,9
bind=$MODSHIFT,0,movetoworkspace,10
bind=$MOD,mouse_down,workspace,e+1
bind=$MOD,mouse_up,workspace,e-1

bind=$MOD,g,togglegroup
bind=$MODSHIFT,g,changegroupactive,f
bind=$MODCTL,g,changegroupactive,g
